{"numFailedTestSuites":2,"numFailedTests":2,"numPassedTestSuites":7,"numPassedTests":11,"numPendingTestSuites":0,"numPendingTests":0,"numRuntimeErrorTestSuites":0,"numTodoTests":0,"numTotalTestSuites":9,"numTotalTests":13,"openHandles":[],"snapshot":{"added":0,"didUpdate":false,"failure":false,"filesAdded":0,"filesRemoved":0,"filesRemovedList":[],"filesUnmatched":0,"filesUpdated":0,"matched":0,"total":0,"unchecked":0,"uncheckedKeysByFile":[],"unmatched":0,"updated":0},"startTime":1766407194438,"success":false,"testResults":[{"assertionResults":[{"ancestorTitles":[],"duration":9,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"blocks unverified business","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766407206536,"status":"passed","title":"blocks unverified business"},{"ancestorTitles":[],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"blocks low trust business","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766407206546,"status":"passed","title":"blocks low trust business"},{"ancestorTitles":[],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"allows verified trusted business","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766407206546,"status":"passed","title":"allows verified trusted business"}],"endTime":1766407206549,"message":"","name":"C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\business.test.ts","startTime":1766407196979,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":[],"duration":6,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"returns ML score and risk level","invocations":1,"location":null,"numPassingAsserts":2,"retryReasons":[],"startAt":1766407206975,"status":"passed","title":"returns ML score and risk level"}],"endTime":1766407206983,"message":"","name":"C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\ml.integration.test.ts","startTime":1766407206593,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":[],"duration":4,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"assigns LOW risk correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766407207179,"status":"passed","title":"assigns LOW risk correctly"},{"ancestorTitles":[],"duration":0,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"assigns MEDIUM risk correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766407207184,"status":"passed","title":"assigns MEDIUM risk correctly"},{"ancestorTitles":[],"duration":1,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"assigns HIGH risk correctly","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766407207184,"status":"passed","title":"assigns HIGH risk correctly"}],"endTime":1766407207186,"message":"","name":"C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\scoring.test.ts","startTime":1766407207011,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":[],"duration":505,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"reports spam","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766407208521,"status":"passed","title":"reports spam"}],"endTime":1766407209030,"message":"","name":"C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\spam.test.ts","startTime":1766407196786,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":[],"duration":5022,"failing":false,"failureDetails":[{"message":"thrown: \"Exceeded timeout of 5000 ms for a test.\nAdd a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\""}],"failureMessages":["Error: thrown: \"Exceeded timeout of 5000 ms for a test.\nAdd a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\"\n    at Object.<anonymous> (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\auth.test.ts:4:1)\n    at Runtime._execModule (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\jest-runtime\\build\\index.js:1268:24)\n    at Runtime._loadModule (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\jest-runtime\\build\\index.js:944:12)\n    at Runtime.requireModule (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\jest-runtime\\build\\index.js:832:12)\n    at jestAdapter (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\jest-circus\\build\\runner.js:95:13)\n    at processTicksAndRejections (node:internal/process/task_queues:95:5)\n    at runTestInternal (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\jest-runner\\build\\testWorker.js:275:16)\n    at runTest (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\jest-runner\\build\\testWorker.js:343:7)\n    at Object.worker (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\jest-runner\\build\\testWorker.js:497:12)"],"fullName":"logs in a user","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766407205091,"status":"failed","title":"logs in a user"}],"endTime":1766407210190,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mlogs in a user\u001b[39m\u001b[22m\n\n    thrown: \"Exceeded timeout of 5000 ms for a test.\n    Add a timeout value to this test to increase the timeout, if this is a long-running test. See https://jestjs.io/docs/api#testname-fn-timeout.\"\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 2 |\u001b[39m \u001b[36mimport\u001b[39m app \u001b[36mfrom\u001b[39m \u001b[32m\"../app\"\u001b[39m\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 3 |\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 4 |\u001b[39m it(\u001b[32m\"logs in a user\"\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m   |\u001b[39m \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 5 |\u001b[39m   \u001b[36mconst\u001b[39m res \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m request(app)\u001b[22m\n\u001b[2m     \u001b[90m 6 |\u001b[39m     \u001b[33m.\u001b[39mpost(\u001b[32m\"/auth/login\"\u001b[39m)\u001b[22m\n\u001b[2m     \u001b[90m 7 |\u001b[39m     \u001b[33m.\u001b[39msend({ phoneNumber\u001b[33m:\u001b[39m \u001b[32m\"0820000000\"\u001b[39m })\u001b[33m;\u001b[39m\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/tests/auth.test.ts\u001b[39m\u001b[0m\u001b[2m:4:1)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\auth.test.ts","startTime":1766407196763,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":[],"duration":3352,"failing":false,"failureDetails":[{"name":"PrismaClientKnownRequestError","code":"P2002","clientVersion":"5.22.0","meta":{"modelName":"Business","target":["registrationNo"]}}],"failureMessages":["PrismaClientKnownRequestError: \nInvalid `prisma.business.create()` invocation in\nC:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\reputation.test.ts:6:42\n\n  3 \n  4 it(\"applies reputation change without error\", async () => {\n  5   // Create a business and caller first to test strictly\n→ 6   const business = await prisma.business.create(\nUnique constraint failed on the fields: (`registrationNo`)\n    at $n.handleRequestError (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:7315)\n    at $n.handleAndLogRequestError (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6623)\n    at $n.request (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\@prisma\\client\\runtime\\library.js:121:6307)\n    at l (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\node_modules\\@prisma\\client\\runtime\\library.js:130:9633)\n    at Object.<anonymous> (C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\reputation.test.ts:6:20)"],"fullName":"applies reputation change without error","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766407206768,"status":"failed","title":"applies reputation change without error"}],"endTime":1766407210193,"message":"\u001b[1m\u001b[31m  \u001b[1m● \u001b[22m\u001b[1mapplies reputation change without error\u001b[39m\u001b[22m\n\n    PrismaClientKnownRequestError: \n    Invalid `prisma.business.create()` invocation in\n    C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\reputation.test.ts:6:42\n\n      3 \n      4 it(\"applies reputation change without error\", async () => {\n      5   // Create a business and caller first to test strictly\n    → 6   const business = await prisma.business.create(\n    Unique constraint failed on the fields: (`registrationNo`)\n\u001b[2m\u001b[22m\n\u001b[2m    \u001b[0m \u001b[90m 4 |\u001b[39m it(\u001b[32m\"applies reputation change without error\"\u001b[39m\u001b[33m,\u001b[39m \u001b[36masync\u001b[39m () \u001b[33m=>\u001b[39m {\u001b[22m\n\u001b[2m     \u001b[90m 5 |\u001b[39m   \u001b[90m// Create a business and caller first to test strictly\u001b[39m\u001b[22m\n\u001b[2m    \u001b[31m\u001b[1m>\u001b[22m\u001b[2m\u001b[39m\u001b[90m 6 |\u001b[39m   \u001b[36mconst\u001b[39m business \u001b[33m=\u001b[39m \u001b[36mawait\u001b[39m prisma\u001b[33m.\u001b[39mbusiness\u001b[33m.\u001b[39mcreate({\u001b[22m\n\u001b[2m     \u001b[90m   |\u001b[39m                    \u001b[31m\u001b[1m^\u001b[22m\u001b[2m\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 7 |\u001b[39m     data\u001b[33m:\u001b[39m { name\u001b[33m:\u001b[39m \u001b[32m\"Test Corp\"\u001b[39m\u001b[33m,\u001b[39m registrationNo\u001b[33m:\u001b[39m \u001b[32m\"123\"\u001b[39m\u001b[33m,\u001b[39m trustScore\u001b[33m:\u001b[39m \u001b[35m50\u001b[39m }\u001b[33m,\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 8 |\u001b[39m   })\u001b[33m;\u001b[39m\u001b[22m\n\u001b[2m     \u001b[90m 9 |\u001b[39m   \u001b[36mawait\u001b[39m prisma\u001b[33m.\u001b[39mbusinessCaller\u001b[33m.\u001b[39mcreate({\u001b[0m\u001b[22m\n\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat $n.handleRequestError (\u001b[22m\u001b[2mnode_modules/@prisma/client/runtime/library.js\u001b[2m:121:7315)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat $n.handleAndLogRequestError (\u001b[22m\u001b[2mnode_modules/@prisma/client/runtime/library.js\u001b[2m:121:6623)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat $n.request (\u001b[22m\u001b[2mnode_modules/@prisma/client/runtime/library.js\u001b[2m:121:6307)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat l (\u001b[22m\u001b[2mnode_modules/@prisma/client/runtime/library.js\u001b[2m:130:9633)\u001b[22m\u001b[2m\u001b[22m\n\u001b[2m      \u001b[2mat Object.<anonymous> (\u001b[22m\u001b[2m\u001b[0m\u001b[36msrc/tests/reputation.test.ts\u001b[39m\u001b[0m\u001b[2m:6:20)\u001b[22m\u001b[2m\u001b[22m\n","name":"C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\reputation.test.ts","startTime":1766407196902,"status":"failed","summary":""},{"assertionResults":[{"ancestorTitles":[],"duration":771,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"logs incoming call","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766407210703,"status":"passed","title":"logs incoming call"}],"endTime":1766407211476,"message":"","name":"C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\call.intake.test.ts","startTime":1766407196751,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":[],"duration":2466,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"grants and revokes consent","invocations":1,"location":null,"numPassingAsserts":0,"retryReasons":[],"startAt":1766407210387,"status":"passed","title":"grants and revokes consent"}],"endTime":1766407212856,"message":"","name":"C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\consent.test.ts","startTime":1766407196873,"status":"passed","summary":""},{"assertionResults":[{"ancestorTitles":[],"duration":9365,"failing":false,"failureDetails":[],"failureMessages":[],"fullName":"blocks when spam threshold exceeded and no consent","invocations":1,"location":null,"numPassingAsserts":1,"retryReasons":[],"startAt":1766407206943,"status":"passed","title":"blocks when spam threshold exceeded and no consent"}],"endTime":1766407216312,"message":"","name":"C:\\Users\\5907\\Documents\\Projects\\Tsediyalo\\CallTrust\\Backend\\src\\tests\\call.policy.test.ts","startTime":1766407196923,"status":"passed","summary":""}],"wasInterrupted":false}
